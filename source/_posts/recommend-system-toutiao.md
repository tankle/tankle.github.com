---
title: 推荐系统简介
date: 2018-01-18 10:33:04
tags:
- 推荐系统
- 机器学习
---

## 系统概览

推荐系统是在特定的场景下，根据用户的偏好，推荐最相关的内容给用户。

形式化的表达方式就是拟合一个用户对内容满意度的函数$$y = F(x_i, x_u, x_c)$$，函数的输入部分包含三个输入维度:1. 内容维度； 2. 用户维度； 3. 环境维度

衡量目标：点击率、阅读时间、点赞、评论、转发等

还需要引入一些无法直接衡量的目标：
* 广告&特型内容频控
* 低俗内容打压等

## 典型推荐算法
* 协同过滤
* LR
* DNN
* FM： Factorization Machine
* DBDT

## 典型的特征
第一类是相关性特征，就是评估内容的属性和与用户是否匹配。显性的匹配包括关键词匹配、分类匹配、来源匹配、主题匹配等。像FM模型中也有一些隐性匹配，从用户向量与内容向量的距离可以得出。

第二类是环境特征，包括地理位置、时间。这些既是bias特征，也能以此构建一些匹配特征。

第三类是热度特征。包括全局热度、分类热度，主题热度，以及关键词热度等。内容热度信息在大的推荐系统特别在用户冷启动的时候非常有效。


模型的训练上，头条系大部分推荐产品采用实时训练。实时训练省资源并且反馈快，这对信息流产品非常重要。


## 数据依赖
1. 推荐模型特征抽取需要用户侧和内容策的各种标签
2. 召回策略需要获取用户侧和内容侧的各种标签
3. 内容分析和用户标签挖掘是搭建推荐系统的基石


## 内容分析

今日头条推荐系统主要抽取的文本特征包括以下几类。

* 首先是语义标签类特征，显式为文章打上语义标签。这部分标签是由人定义的特征，每个标签有明确的意义，标签体系是预定义的。
* 此外还有隐式语义特征，主要是topic特征和关键词特征，其中topic特征是对于词概率分布的描述，无明确意义；
* 而关键词特征会基于一些统一特征描述，无明确集合。


## 用户标签
* 兴趣特征
    感兴趣的类别和主体
    感兴趣的关键词
    来源
    基于兴趣的用户聚类

* 身份特征
    性别，年龄、常驻地点

    年龄信息通常由模型预测，通过机型、阅读时间分布等预估。
* 行为特征
    晚上才看视频

### 用户标签的过滤
* 过滤噪声
* 热点惩罚
* 时间衰减
* 惩罚展现
* 考虑全局背景

### 用户标签批量计算框架
* 每天抽取昨天使用过头条的用户
* 抽取这些用户最近两个月的动作数据
* 在集群上批量计算结果

问题： 随着用户的增长，计算完成、写入等成为瓶颈

### 用户标签流式计算框架
* storm 集群实时处理用户
* 每收集一定量(batch)的用户数据就重新计算一次用户兴趣模型


流式和批量计算混合使用：像用户的性别、年龄、常驻地点这些信息，不需要实时重复计算，就仍然保留daily更新。


## 评估分析
需要注意的问题：
* 兼顾短期指标和长期指标
* 兼顾用户指标和生态指标：比如原创作者、阅读用户以及广告主
* 注意协同效应的影响，有时候需要做彻底的统计隔离
